"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.response = exports.request = void 0;
const utils_1 = require("@aws-appsync/utils");
const helpers_1 = require("../lib/helpers");
function request(ctx) {
    // add timestamps
    const user = (0, helpers_1.createItem)(ctx.args.input);
    const id = utils_1.util.autoId();
    return {
        operation: "PutItem",
        key: {
            PK: utils_1.util.dynamodb.toDynamoDB(`USER#${id}`),
            SK: utils_1.util.dynamodb.toDynamoDB(`USER#${id}`),
        },
        attributeValues: utils_1.util.dynamodb.toMapValues({
            publishDate: utils_1.util.time.nowISO8601(),
            ...user,
            UserInventoryIndexPK: `USER`,
            UserInventoryIndexSK: `USER#${id}`,
        }),
    };
}
exports.request = request;
function response(ctx) {
    console.log("CREATED USER", ctx.result);
    return ctx.result;
}
exports.response = response;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlVXNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNyZWF0ZVVzZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsOENBQTJFO0FBQzNFLDRDQUE0QztBQUc1QyxTQUFnQixPQUFPLENBQ3JCLEdBQW9DO0lBRXBDLGlCQUFpQjtJQUNqQixNQUFNLElBQUksR0FBRyxJQUFBLG9CQUFVLEVBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN4QyxNQUFNLEVBQUUsR0FBRyxZQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDekIsT0FBTztRQUNMLFNBQVMsRUFBRSxTQUFTO1FBQ3BCLEdBQUcsRUFBRTtZQUNILEVBQUUsRUFBRSxZQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDO1lBQzFDLEVBQUUsRUFBRSxZQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDO1NBQzNDO1FBQ0QsZUFBZSxFQUFFLFlBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDO1lBQ3pDLFdBQVcsRUFBRSxZQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNuQyxHQUFHLElBQUk7WUFDUCxvQkFBb0IsRUFBRSxNQUFNO1lBQzVCLG9CQUFvQixFQUFFLFFBQVEsRUFBRSxFQUFFO1NBQ25DLENBQUM7S0FDSCxDQUFDO0FBQ0osQ0FBQztBQW5CRCwwQkFtQkM7QUFFRCxTQUFnQixRQUFRLENBQUMsR0FBMEM7SUFDakUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3hDLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztBQUNwQixDQUFDO0FBSEQsNEJBR0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZXh0LCBEeW5hbW9EQlB1dEl0ZW1SZXF1ZXN0LCB1dGlsIH0gZnJvbSBcIkBhd3MtYXBwc3luYy91dGlsc1wiO1xuaW1wb3J0IHsgY3JlYXRlSXRlbSB9IGZyb20gXCIuLi9saWIvaGVscGVyc1wiO1xuaW1wb3J0IHsgTXV0YXRpb25DcmVhdGVVc2VyQXJncywgVXNlciB9IGZyb20gXCIuLi90eXBlcy9hcHBzeW5jXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1ZXN0KFxuICBjdHg6IENvbnRleHQ8TXV0YXRpb25DcmVhdGVVc2VyQXJncz5cbik6IER5bmFtb0RCUHV0SXRlbVJlcXVlc3Qge1xuICAvLyBhZGQgdGltZXN0YW1wc1xuICBjb25zdCB1c2VyID0gY3JlYXRlSXRlbShjdHguYXJncy5pbnB1dCk7XG4gIGNvbnN0IGlkID0gdXRpbC5hdXRvSWQoKTtcbiAgcmV0dXJuIHtcbiAgICBvcGVyYXRpb246IFwiUHV0SXRlbVwiLFxuICAgIGtleToge1xuICAgICAgUEs6IHV0aWwuZHluYW1vZGIudG9EeW5hbW9EQihgVVNFUiMke2lkfWApLFxuICAgICAgU0s6IHV0aWwuZHluYW1vZGIudG9EeW5hbW9EQihgVVNFUiMke2lkfWApLFxuICAgIH0sXG4gICAgYXR0cmlidXRlVmFsdWVzOiB1dGlsLmR5bmFtb2RiLnRvTWFwVmFsdWVzKHtcbiAgICAgIHB1Ymxpc2hEYXRlOiB1dGlsLnRpbWUubm93SVNPODYwMSgpLFxuICAgICAgLi4udXNlcixcbiAgICAgIFVzZXJJbnZlbnRvcnlJbmRleFBLOiBgVVNFUmAsXG4gICAgICBVc2VySW52ZW50b3J5SW5kZXhTSzogYFVTRVIjJHtpZH1gLFxuICAgIH0pLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzcG9uc2UoY3R4OiBDb250ZXh0PE11dGF0aW9uQ3JlYXRlVXNlckFyZ3MsIFVzZXI+KSB7XG4gIGNvbnNvbGUubG9nKFwiQ1JFQVRFRCBVU0VSXCIsIGN0eC5yZXN1bHQpO1xuICByZXR1cm4gY3R4LnJlc3VsdDtcbn1cbiJdfQ==